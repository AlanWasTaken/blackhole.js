blackHole.js
============

## Introduce

[![Blackhole.js](http://i.imgur.com/6d588zV.png)](http://codepen.io/artzub/pen/vcfyd)

This library is child of two parents:  
* [WorldBank Contract Awards](http://d3.artzub.com/wbca/)
* [GitHub Visualizer](http://artzub.com/ghv)

The main objective of this library is the visualization of data that change over time.
Suitable for the visualization of such data as:
* Commits history ([GitHub Visualizer](http://artzub.com/ghv)) 
* Economic Indicators ([Distribution of Russian budget 2013](http://clearspending.artzub.com/), [LuckyLunch](http://works.artzub.com/luckylunch/))
* Network attacks ([NetMonitor](http://artzub.com/img/demo_netMon.gif)) 
* And etc.

Depends of [D3js](http://d3js.org)

## Structure

- [Quick Example](#qe)
- [Documentation](#api)
    - [Properties](#properties)
    - [Settings](#settings)
    - [Methods](#methods)
- [For developers](#fd)

<a name="qe" />
## Quick Examples
  

> For fast look [Example I](http://codepen.io/artzub/pen/vcfyd)

We have data (generated by [script](http://codepen.io/artzub/pen/bIkvH.js)):

```json
[
  {
    "key": 119,
    "category": "nemo,",
    "parent": {
      "name": "cumque5",
      "key": 5
    },
    "date": "2014-01-29T15:39:45.340Z"
  },
  {
    "key": 96,
    "category": "nemo,",
    "parent": {
      "name": "cumque5",
      "key": 5
    },
    "date": "2014-01-29T19:56:18.885Z"
  },
  {
    "key": 125,
    "category": "nemo,",
    "parent": {
      "name": "cumque5",
      "key": 5
    },
    "date": "2014-01-30T01:00:53.648Z"
  },
  {
    "key": 51,
    "category": "nemo,",
    "parent": {
      "name": "eveniet1",
      "key": 1
    },
    "date": "2014-01-30T06:46:51.531Z"
  },
  {
    "key": 237,
    "category": "nemo,",
    "parent": {
      "name": "cumque5",
      "key": 5
    },
    "date": "2014-01-30T12:25:14.810Z"
  },
  //...
]
```

And code:

```html
<div id="canvas"></div>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://lib.artzub.com/js/blackhole.js/blackhole.js"></script>
<script>
var data = rawData.map(function(d) {
        d.date = new Date(d.date);
        return d;
    })
    , stepDate = 864e5
    , d3bh = d3.blackHole("#canvas")
    ;

d3bh.setting.drawTrack = true;

d3bh.on('calcRightBound', function(l) {
        return +l + stepDate;
    })
    .start(data)
    ;
</script>
```

<a name="api" />
## Documentation

For creation instance of the blackHole object, need call method of the d3js object
```javascript
var bh = d3.blackHole('#canvas');
```
__d3.blackHole(node)__  
> __node__ — or a selector, or a dom node, or a d3 node  
> returning the blackHole object

will further describe the properties and methods of the blackHole object.

### Properties

* __version__ — the version of library
* __setting__ — object with fields of [settings](#settings)

### Settings

All fields can change dynamic.  

* #### Items
    * *bh.setting.*__alpha__ — uses for calculation cluster (default: `0.025`)
    * *bh.setting.*__childLife__ — number of ticks of life a child node (default: `255`)
    * *bh.setting.*__parentLife__ — number of ticks of life a parent node, after the death of all children (default: `255`)
    * *bh.setting.*__rateOpacity__ — rate of decrease of opacity (default: `.5`)
    * *bh.setting.*__rateFlash__ — rate of decrease of flash effect (default: `2.5`)
    * *bh.setting.*__padding__ — padding of parent (default: `25`)

* #### Behavior
    * *bh.setting.*__skipEmptyDate__ — skips empty dates (default: `true`).  
        
        > if after filtering data, an array is empty then it steps on next date.
           
    * *bh.setting.*__realtime__ — indicates that need work in mode realtime (default: `false`).
       
        > *This parameters must be initialized before starting visualization.*
          
    * *bh.setting.*__asyncParsing__ — parsing data in async mode (default: `false`).
      
        > If param is true, then will work method [.on('parsing')](#on_parsing)  
        > *This parameters must be initialized before starting visualization.* 
         
    * *bh.setting.*__speed__ — sets milliseconds for `setInterval` of method filtering data (default: `1000`)
        
        > *This parameters must be initialized before starting visualization.*  
        > After need use [speed](#speed) method
        
    * *bh.setting.*__increaseChildWhenCreated__ — increase children nodes when they are created (default: `false`)
    * *bh.setting.*__createNearParent__ — create children nodes near they parents (default: `false`)

* #### Drawing
    * *bh.setting.*__blendingLighter__ — if true, then sets the property `compositeOperation` of canvas in the `'lighter'` value (default: `true`)
    * *bh.setting.*__drawEdge__ — drawing edges (default: `false`)
    * *bh.setting.*__drawChild__ — drawing children nodes (default: `true`)
    * *bh.setting.*__drawChildLabel__ — drawing labels of children nodes (default: `false`)
    * *bh.setting.*__drawParent__ — drawing parents nodes (default: `true`)
    * *bh.setting.*__drawParentLabel__ — drawing labels of parents nodes (default: `true`) 
    * *bh.setting.*__drawPaddingCircle__ — drawing padding circles of parents nodes (default: `false`) 
    * *bh.setting.*__drawHalo__ — drawing the halo effect of children nodes (default: `true`)
    * *bh.setting.*__drawTrack__ — drawing track of children nodes (default: `true`)
    * *bh.setting.*__drawAsPlasma__ — drawing children nodes uses plasma effect (default: `true`)
    * *bh.setting.*__drawParentImg__ — drawing images of parents nodes (default: `true`) 
    * *bh.setting.*__hasLabelMaxWidth__ — if true, then uses the `maxWidth` argument into the `fillText` method, in other words, text zooming based on the max width of canvas. (default: `true`) 

* #### Colors
    * *bh.setting.*__colorless__ — a color for bleaching (default: `rgb(128, 128, 128)`)
    * *bh.setting.*__colorlessFlash__ — a color for bleaching when using the flash effect (default: `rgb(211, 211, 211)`)
    * *bh.setting.*__parentColors__ — colors of parents nodes (default: `d3.scale.category20b()`)
    
        > it is a `d3.scale.ordinal` object, can initialised as `d3.scale.ordinal.domain(['pie', 'roll', ...]).range(['red', 'blue', ...])`  
        > [more about d3 category](https://github.com/mbostock/d3/blob/master/src/scale/category.js)
          
    * *bh.setting.*__categoryColors__ — colors of children nodes categories (default: `d3.scale.category20()`)

* #### Zoom and drag
    * *bh.setting.*__zoomAndDrag__ — enable zooming and dragging canvas (default: `true`)
    * *bh.setting.*__zoom__ — a function `d3.zoom` (default: ~~generate when start visualization~~)
    * *bh.setting.*__scale__ — initial `scale` of canvas (default: `1`)
    * *bh.setting.*__translate__ — initial `translate` of canvas (default: `[0, 0]`)
    * *bh.setting.*__scaleExtent__ — scale extent for `d3.zoom` (default: `[.1, 8]`)

### Methods

* __[start](#start)()__<a name="start" />
* __[stop](#stop)()__<a name="stop" />
* __[pause](#pause)()__<a name="pause" />
* __[resume](#resume)()__<a name="resume" />
* __[append](#append)()__<a name="append" />
* __[IsRun](#is-run)()__<a name="is-run" />
* __[IsPaused](#is-paused)()__<a name="is-paused" />

* __[selectNode](#select-node)(node)__<a name="select-node" />
* __[selectCategory](#select-category)(category)__<a name="select-category" />
* __[frozenCategory](#frozen-category)(category)__<a name="frozen-category" />

* __[parents](#parents)(arg)__<a name="parents" />
* __[children](#children)(arg)__<a name="children" />
* __[categories](#categories)(arg)__<a name="categories" />
* __[categoryMax](#category-max)(val)__<a name="category-max" />

* __[sort](#sort)(func)__<a name="sort" />
    > function(a, b){}  
* __[filter](#filter)(func)__<a name="filter" />
    > function(l, r){}  

* __[speed](#speed)(millisecond)__<a name="speed" />
* __[size](#size)__<a name="size" />
* __[translate](#translate)__<a name="translate" />
* __[style](#style)(name, value, priority)__<a name="style" />
* __[scale](#scale)__<a name="scale" />
* __[getCanvas](#get-canvas)__<a name="get-canvas" />
* __[findStyleProperty](#find-style-property)()__<a name="find-style-property" />

* __[on](#on)(key, value)__<a name="on" />  

    > ***key*** — string value form __keys__  
    > ***value*** — function  

    |  key  | value | description |
    | ----- | ----- | ----------- |
    | __[calcRightBound](#on-calc-right-bound)__<a name="on-calc-right-bound" /> |  |  |
    | __[processing](#on-processing)__<a name="on-processing" /> |  |  |
    | __[processed](#on-processed)__<a name="on-processed" /> |  |  |
    | __[stopped](#on-stopped)__<a name="on-stopped" /> |  |  |
    | __[beforeParsing](#on-before-parsing)__<a name="on-before-parsing" /> |  |  |
    | __[parsing](#on-parsing)__<a name="on-parsing" /> |  |  |
    | __[afterParsing](#on-after-parsing)__<a name="on-after-parsing" /> |  |  |
    | __[getChildLabel](#on-get-child-label)__<a name="on-get-child-label" /> |  |  |
    | __[getParentLabel](#on-get-parent-label)__<a name="on-get-parent-label" /> |  |  |
    | __[getSelectedColor](#on-get-selected-color)__<a name="on-get-selected-color" /> |  |  |
    | __[getVisibleByStep](#on-get-visible-by-step)__<a name="on-get-visible-by-step" /> |  |  |
    | __[getCreateNearParent](#on-get-create-near-parent)__<a name="on-get-create-near-parent" /> |  |  |
    | __[getName](#on-get-name)__<a name="on-get-name" /> |  |  |
    | __[getCategoryKey](#on-get-category-key)__<a name="on-get-category-key" /> |  |  |
    | __[getCategoryName](#on-get-category-name)__<a name="on-get-category-name" /> |  |  |
    | __[getKey](#on-get-key)__<a name="on-get-key" /> |  |  |
    | __[getChildKey](#on-get-child-key)__<a name="on-get-child-key" /> |  |  |
    | __[getParentKey](#on-get-parent-key)__<a name="on-get-parent-key" /> |  |  |
    | __[getParent](#on-get-parent)__<a name="on-get-parent" /> |  |  |
    | __[getParentImage](#on-get-parent-image)__<a name="on-get-parent-image" /> |  |  |
    | __[getGroupBy](#on-get-group-by)__<a name="on-get-group-by" /> |  |  |
    | __[getValue](#on-get-value)__<a name="on-get-value" /> |  |  |
    | __[getParentRadius](#on-get-parent-radius)__<a name="on-get-parent-radius" /> |  |  |
    | __[getChildRadius](#on-get-child-radius)__<a name="on-get-child-radius" /> |  |  |
    | __[getParentPosition](#on-get-parent-position)__<a name="on-get-parent-position" /> |  |  |
    | __[getParentFixed](#on-get-parent-fixed)__<a name="on-get-parent-fixed" /> |  |  |
    | __[finished](#on-finished)__<a name="on-finished" /> |  |  |
    | __[starting](#on-starting)__<a name="on-starting" /> |  |  |
    | __[started](#on-started)__<a name="on-started" /> |  |  |
    | __[mouseOverNode](#on-mouse-over-node)__<a name="on-mouse-over-node" /> |  |  |
    | __[mouseMove](#on-mouse-move)__<a name="on-mouse-move" /> |  |  |
    | __[mouseOutNode](#on-mouse-out-node)__<a name="on-mouse-out-node" /> |  |  |
    | __[particleAtTarget](#particleattarget)__<a name="on-particle-at-target" /> |  |  |
    
<a name="fd" />
## For developers

![ga](http://www.google-analytics.com/__utm.gif?utmwv=4&utmac=UA-28343295-16&utmdt=blackholeReadme&utmhid=2052327202&utmn=1)
